.include "macros.s"

.section .text, "ax"  # 0x800058A0 - 0x800764A0 ; 0x00070C00


.global __CARDGetFatBlock
__CARDGetFatBlock:
/* 800254FC 0002231C  80 63 00 88 */	lwz r3, 0x88(r3)
/* 80025500 00022320  4E 80 00 20 */	blr

WriteCallback:
/* 80025504 00022324  7C 08 02 A6 */	mflr r0
/* 80025508 00022328  90 01 00 04 */	stw r0, 0x4(r1)
/* 8002550C 0002232C  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 80025510 00022330  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 80025514 00022334  93 C1 00 18 */	stw r30, 0x18(r1)
/* 80025518 00022338  7C 9E 23 79 */	mr. r30, r4
/* 8002551C 0002233C  93 A1 00 14 */	stw r29, 0x14(r1)
/* 80025520 00022340  3B A3 00 00 */	addi r29, r3, 0x0
/* 80025524 00022344  1C BD 01 10 */	mulli r5, r29, 0x110
/* 80025528 00022348  3C 60 80 0A */	lis r3, __CARDBlock@ha
/* 8002552C 0002234C  38 03 3D 40 */	addi r0, r3, __CARDBlock@l
/* 80025530 00022350  7F E0 2A 14 */	add r31, r0, r5
/* 80025534 00022354  41 80 00 48 */	blt lbl_8002557C
/* 80025538 00022358  80 7F 00 80 */	lwz r3, 0x80(r31)
/* 8002553C 0002235C  80 1F 00 88 */	lwz r0, 0x88(r31)
/* 80025540 00022360  38 83 60 00 */	addi r4, r3, 0x6000
/* 80025544 00022364  7C 00 20 40 */	cmplw r0, r4
/* 80025548 00022368  3C A3 00 01 */	addis r5, r3, 0x1
/* 8002554C 0002236C  38 A5 80 00 */	addi r5, r5, -0x8000
/* 80025550 00022370  40 82 00 18 */	bne lbl_80025568
/* 80025554 00022374  90 BF 00 88 */	stw r5, 0x88(r31)
/* 80025558 00022378  38 65 00 00 */	addi r3, r5, 0x0
/* 8002555C 0002237C  38 A0 20 00 */	li r5, 0x2000
/* 80025560 00022380  4B FD DC 89 */	bl memcpy
/* 80025564 00022384  48 00 00 18 */	b lbl_8002557C
lbl_80025568:
/* 80025568 00022388  90 9F 00 88 */	stw r4, 0x88(r31)
/* 8002556C 0002238C  38 64 00 00 */	addi r3, r4, 0x0
/* 80025570 00022390  38 85 00 00 */	addi r4, r5, 0x0
/* 80025574 00022394  38 A0 20 00 */	li r5, 0x2000
/* 80025578 00022398  4B FD DC 71 */	bl memcpy
lbl_8002557C:
/* 8002557C 0002239C  80 1F 00 D0 */	lwz r0, 0xd0(r31)
/* 80025580 000223A0  28 00 00 00 */	cmplwi r0, 0x0
/* 80025584 000223A4  40 82 00 10 */	bne lbl_80025594
/* 80025588 000223A8  38 7F 00 00 */	addi r3, r31, 0x0
/* 8002558C 000223AC  38 9E 00 00 */	addi r4, r30, 0x0
/* 80025590 000223B0  4B FF E7 39 */	bl __CARDPutControlBlock
lbl_80025594:
/* 80025594 000223B4  80 1F 00 D8 */	lwz r0, 0xd8(r31)
/* 80025598 000223B8  28 00 00 00 */	cmplwi r0, 0x0
/* 8002559C 000223BC  7C 0C 03 78 */	mr r12, r0
/* 800255A0 000223C0  41 82 00 1C */	beq lbl_800255BC
/* 800255A4 000223C4  38 00 00 00 */	li r0, 0x0
/* 800255A8 000223C8  7D 88 03 A6 */	mtlr r12
/* 800255AC 000223CC  90 1F 00 D8 */	stw r0, 0xd8(r31)
/* 800255B0 000223D0  38 7D 00 00 */	addi r3, r29, 0x0
/* 800255B4 000223D4  38 9E 00 00 */	addi r4, r30, 0x0
/* 800255B8 000223D8  4E 80 00 21 */	blrl
lbl_800255BC:
/* 800255BC 000223DC  80 01 00 24 */	lwz r0, 0x24(r1)
/* 800255C0 000223E0  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 800255C4 000223E4  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 800255C8 000223E8  83 A1 00 14 */	lwz r29, 0x14(r1)
/* 800255CC 000223EC  38 21 00 20 */	addi r1, r1, 0x20
/* 800255D0 000223F0  7C 08 03 A6 */	mtlr r0
/* 800255D4 000223F4  4E 80 00 20 */	blr

EraseCallback:
/* 800255D8 000223F8  7C 08 02 A6 */	mflr r0
/* 800255DC 000223FC  90 01 00 04 */	stw r0, 0x4(r1)
/* 800255E0 00022400  94 21 FF D8 */	stwu r1, -0x28(r1)
/* 800255E4 00022404  93 E1 00 24 */	stw r31, 0x24(r1)
/* 800255E8 00022408  3B E3 00 00 */	addi r31, r3, 0x0
/* 800255EC 0002240C  3C 60 80 0A */	lis r3, __CARDBlock@ha
/* 800255F0 00022410  93 C1 00 20 */	stw r30, 0x20(r1)
/* 800255F4 00022414  1C BF 01 10 */	mulli r5, r31, 0x110
/* 800255F8 00022418  93 A1 00 1C */	stw r29, 0x1c(r1)
/* 800255FC 0002241C  38 03 3D 40 */	addi r0, r3, __CARDBlock@l
/* 80025600 00022420  7C 9D 23 79 */	mr. r29, r4
/* 80025604 00022424  7F C0 2A 14 */	add r30, r0, r5
/* 80025608 00022428  41 80 00 3C */	blt lbl_80025644
/* 8002560C 0002242C  80 BE 00 88 */	lwz r5, 0x88(r30)
/* 80025610 00022430  3C 60 80 02 */	lis r3, WriteCallback@ha
/* 80025614 00022434  80 1E 00 80 */	lwz r0, 0x80(r30)
/* 80025618 00022438  38 E3 55 04 */	addi r7, r3, WriteCallback@l
/* 8002561C 0002243C  80 7E 00 0C */	lwz r3, 0xc(r30)
/* 80025620 00022440  7C 00 28 50 */	subf r0, r0, r5
/* 80025624 00022444  54 00 9B 7E */	srwi r0, r0, 13
/* 80025628 00022448  7C 83 01 D6 */	mullw r4, r3, r0
/* 8002562C 0002244C  38 C5 00 00 */	addi r6, r5, 0x0
/* 80025630 00022450  38 7F 00 00 */	addi r3, r31, 0x0
/* 80025634 00022454  38 A0 20 00 */	li r5, 0x2000
/* 80025638 00022458  4B FF FE 61 */	bl __CARDWrite
/* 8002563C 0002245C  7C 7D 1B 79 */	mr. r29, r3
/* 80025640 00022460  40 80 00 44 */	bge lbl_80025684
lbl_80025644:
/* 80025644 00022464  80 1E 00 D0 */	lwz r0, 0xd0(r30)
/* 80025648 00022468  28 00 00 00 */	cmplwi r0, 0x0
/* 8002564C 0002246C  40 82 00 10 */	bne lbl_8002565C
/* 80025650 00022470  38 7E 00 00 */	addi r3, r30, 0x0
/* 80025654 00022474  38 9D 00 00 */	addi r4, r29, 0x0
/* 80025658 00022478  4B FF E6 71 */	bl __CARDPutControlBlock
lbl_8002565C:
/* 8002565C 0002247C  80 1E 00 D8 */	lwz r0, 0xd8(r30)
/* 80025660 00022480  28 00 00 00 */	cmplwi r0, 0x0
/* 80025664 00022484  7C 0C 03 78 */	mr r12, r0
/* 80025668 00022488  41 82 00 1C */	beq lbl_80025684
/* 8002566C 0002248C  38 00 00 00 */	li r0, 0x0
/* 80025670 00022490  7D 88 03 A6 */	mtlr r12
/* 80025674 00022494  90 1E 00 D8 */	stw r0, 0xd8(r30)
/* 80025678 00022498  38 7F 00 00 */	addi r3, r31, 0x0
/* 8002567C 0002249C  38 9D 00 00 */	addi r4, r29, 0x0
/* 80025680 000224A0  4E 80 00 21 */	blrl
lbl_80025684:
/* 80025684 000224A4  80 01 00 2C */	lwz r0, 0x2c(r1)
/* 80025688 000224A8  83 E1 00 24 */	lwz r31, 0x24(r1)
/* 8002568C 000224AC  83 C1 00 20 */	lwz r30, 0x20(r1)
/* 80025690 000224B0  83 A1 00 1C */	lwz r29, 0x1c(r1)
/* 80025694 000224B4  38 21 00 28 */	addi r1, r1, 0x28
/* 80025698 000224B8  7C 08 03 A6 */	mtlr r0
/* 8002569C 000224BC  4E 80 00 20 */	blr

.global __CARDAllocBlock
__CARDAllocBlock:
/* 800256A0 000224C0  7C 08 02 A6 */	mflr r0
/* 800256A4 000224C4  1C E3 01 10 */	mulli r7, r3, 0x110
/* 800256A8 000224C8  90 01 00 04 */	stw r0, 0x4(r1)
/* 800256AC 000224CC  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 800256B0 000224D0  3C C0 80 0A */	lis r6, __CARDBlock@ha
/* 800256B4 000224D4  38 06 3D 40 */	addi r0, r6, __CARDBlock@l
/* 800256B8 000224D8  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 800256BC 000224DC  7D 20 3A 14 */	add r9, r0, r7
/* 800256C0 000224E0  93 C1 00 18 */	stw r30, 0x18(r1)
/* 800256C4 000224E4  80 09 00 00 */	lwz r0, 0x0(r9)
/* 800256C8 000224E8  2C 00 00 00 */	cmpwi r0, 0x0
/* 800256CC 000224EC  40 82 00 0C */	bne lbl_800256D8
/* 800256D0 000224F0  38 60 FF FD */	li r3, -0x3
/* 800256D4 000224F4  48 00 00 CC */	b lbl_800257A0
lbl_800256D8:
/* 800256D8 000224F8  81 09 00 88 */	lwz r8, 0x88(r9)
/* 800256DC 000224FC  A0 08 00 06 */	lhz r0, 0x6(r8)
/* 800256E0 00022500  7C 00 20 40 */	cmplw r0, r4
/* 800256E4 00022504  40 80 00 0C */	bge lbl_800256F0
/* 800256E8 00022508  38 60 FF F7 */	li r3, -0x9
/* 800256EC 0002250C  48 00 00 B4 */	b lbl_800257A0
lbl_800256F0:
/* 800256F0 00022510  7C 04 00 50 */	subf r0, r4, r0
/* 800256F4 00022514  B0 08 00 06 */	sth r0, 0x6(r8)
/* 800256F8 00022518  3C C0 00 01 */	lis r6, 0x1
/* 800256FC 0002251C  39 86 FF FF */	addi r12, r6, -0x1
/* 80025700 00022520  A1 68 00 08 */	lhz r11, 0x8(r8)
/* 80025704 00022524  38 0C 00 00 */	addi r0, r12, 0x0
/* 80025708 00022528  3B C0 00 00 */	li r30, 0x0
/* 8002570C 0002252C  48 00 00 7C */	b lbl_80025788
lbl_80025710:
/* 80025710 00022530  A1 49 00 10 */	lhz r10, 0x10(r9)
/* 80025714 00022534  3B DE 00 01 */	addi r30, r30, 0x1
/* 80025718 00022538  57 C6 04 3E */	clrlwi r6, r30, 16
/* 8002571C 0002253C  38 EA FF FB */	addi r7, r10, -0x5
/* 80025720 00022540  7C 07 30 00 */	cmpw r7, r6
/* 80025724 00022544  40 80 00 0C */	bge lbl_80025730
/* 80025728 00022548  38 60 FF FA */	li r3, -0x6
/* 8002572C 0002254C  48 00 00 74 */	b lbl_800257A0
lbl_80025730:
/* 80025730 00022550  39 6B 00 01 */	addi r11, r11, 0x1
/* 80025734 00022554  55 66 04 3E */	clrlwi r6, r11, 16
/* 80025738 00022558  28 06 00 05 */	cmplwi r6, 0x5
/* 8002573C 0002255C  41 80 00 0C */	blt lbl_80025748
/* 80025740 00022560  7C 06 50 40 */	cmplw r6, r10
/* 80025744 00022564  41 80 00 08 */	blt lbl_8002574C
lbl_80025748:
/* 80025748 00022568  39 60 00 05 */	li r11, 0x5
lbl_8002574C:
/* 8002574C 0002256C  55 66 0B FC */	rlwinm r6, r11, 1, 15, 30
/* 80025750 00022570  7C E8 32 14 */	add r7, r8, r6
/* 80025754 00022574  A0 C7 00 00 */	lhz r6, 0x0(r7)
/* 80025758 00022578  28 06 00 00 */	cmplwi r6, 0x0
/* 8002575C 0002257C  40 82 00 2C */	bne lbl_80025788
/* 80025760 00022580  55 86 04 3E */	clrlwi r6, r12, 16
/* 80025764 00022584  28 06 FF FF */	cmplwi r6, 0xffff
/* 80025768 00022588  40 82 00 0C */	bne lbl_80025774
/* 8002576C 0002258C  7D 6C 5B 78 */	mr r12, r11
/* 80025770 00022590  48 00 00 0C */	b lbl_8002577C
lbl_80025774:
/* 80025774 00022594  57 E6 0B FC */	rlwinm r6, r31, 1, 15, 30
/* 80025778 00022598  7D 68 33 2E */	sthx r11, r8, r6
lbl_8002577C:
/* 8002577C 0002259C  B0 07 00 00 */	sth r0, 0x0(r7)
/* 80025780 000225A0  3B EB 00 00 */	addi r31, r11, 0x0
/* 80025784 000225A4  38 84 FF FF */	addi r4, r4, -0x1
lbl_80025788:
/* 80025788 000225A8  28 04 00 00 */	cmplwi r4, 0x0
/* 8002578C 000225AC  40 82 FF 84 */	bne lbl_80025710
/* 80025790 000225B0  B1 68 00 08 */	sth r11, 0x8(r8)
/* 80025794 000225B4  7D 04 43 78 */	mr r4, r8
/* 80025798 000225B8  B1 89 00 BE */	sth r12, 0xbe(r9)
/* 8002579C 000225BC  48 00 00 B9 */	bl __CARDUpdateFatBlock
lbl_800257A0:
/* 800257A0 000225C0  80 01 00 24 */	lwz r0, 0x24(r1)
/* 800257A4 000225C4  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 800257A8 000225C8  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 800257AC 000225CC  38 21 00 20 */	addi r1, r1, 0x20
/* 800257B0 000225D0  7C 08 03 A6 */	mtlr r0
/* 800257B4 000225D4  4E 80 00 20 */	blr

.global __CARDFreeBlock
__CARDFreeBlock:
/* 800257B8 000225D8  7C 08 02 A6 */	mflr r0
/* 800257BC 000225DC  1C E3 01 10 */	mulli r7, r3, 0x110
/* 800257C0 000225E0  90 01 00 04 */	stw r0, 0x4(r1)
/* 800257C4 000225E4  3C C0 80 0A */	lis r6, __CARDBlock@ha
/* 800257C8 000225E8  94 21 FF F8 */	stwu r1, -0x8(r1)
/* 800257CC 000225EC  38 06 3D 40 */	addi r0, r6, __CARDBlock@l
/* 800257D0 000225F0  7D 20 3A 14 */	add r9, r0, r7
/* 800257D4 000225F4  80 09 00 00 */	lwz r0, 0x0(r9)
/* 800257D8 000225F8  2C 00 00 00 */	cmpwi r0, 0x0
/* 800257DC 000225FC  40 82 00 0C */	bne lbl_800257E8
/* 800257E0 00022600  38 60 FF FD */	li r3, -0x3
/* 800257E4 00022604  48 00 00 60 */	b lbl_80025844
lbl_800257E8:
/* 800257E8 00022608  81 09 00 88 */	lwz r8, 0x88(r9)
/* 800257EC 0002260C  38 E0 00 00 */	li r7, 0x0
/* 800257F0 00022610  48 00 00 40 */	b lbl_80025830
lbl_800257F4:
/* 800257F4 00022614  54 84 04 3E */	clrlwi r4, r4, 16
/* 800257F8 00022618  28 04 00 05 */	cmplwi r4, 0x5
/* 800257FC 0002261C  41 80 00 10 */	blt lbl_8002580C
/* 80025800 00022620  A0 09 00 10 */	lhz r0, 0x10(r9)
/* 80025804 00022624  7C 04 00 40 */	cmplw r4, r0
/* 80025808 00022628  41 80 00 0C */	blt lbl_80025814
lbl_8002580C:
/* 8002580C 0002262C  38 60 FF FA */	li r3, -0x6
/* 80025810 00022630  48 00 00 34 */	b lbl_80025844
lbl_80025814:
/* 80025814 00022634  54 80 08 3C */	slwi r0, r4, 1
/* 80025818 00022638  7C C8 02 14 */	add r6, r8, r0
/* 8002581C 0002263C  A0 86 00 00 */	lhz r4, 0x0(r6)
/* 80025820 00022640  B0 E6 00 00 */	sth r7, 0x0(r6)
/* 80025824 00022644  A0 C8 00 06 */	lhz r6, 0x6(r8)
/* 80025828 00022648  38 06 00 01 */	addi r0, r6, 0x1
/* 8002582C 0002264C  B0 08 00 06 */	sth r0, 0x6(r8)
lbl_80025830:
/* 80025830 00022650  54 80 04 3E */	clrlwi r0, r4, 16
/* 80025834 00022654  28 00 FF FF */	cmplwi r0, 0xffff
/* 80025838 00022658  40 82 FF BC */	bne lbl_800257F4
/* 8002583C 0002265C  7D 04 43 78 */	mr r4, r8
/* 80025840 00022660  48 00 00 15 */	bl __CARDUpdateFatBlock
lbl_80025844:
/* 80025844 00022664  80 01 00 0C */	lwz r0, 0xc(r1)
/* 80025848 00022668  38 21 00 08 */	addi r1, r1, 0x8
/* 8002584C 0002266C  7C 08 03 A6 */	mtlr r0
/* 80025850 00022670  4E 80 00 20 */	blr

.global __CARDUpdateFatBlock
__CARDUpdateFatBlock:
/* 80025854 00022674  7C 08 02 A6 */	mflr r0
/* 80025858 00022678  90 01 00 04 */	stw r0, 0x4(r1)
/* 8002585C 0002267C  94 21 FF D8 */	stwu r1, -0x28(r1)
/* 80025860 00022680  93 E1 00 24 */	stw r31, 0x24(r1)
/* 80025864 00022684  93 C1 00 20 */	stw r30, 0x20(r1)
/* 80025868 00022688  3B C5 00 00 */	addi r30, r5, 0x0
/* 8002586C 0002268C  93 A1 00 1C */	stw r29, 0x1c(r1)
/* 80025870 00022690  3B A4 00 00 */	addi r29, r4, 0x0
/* 80025874 00022694  38 BD 00 00 */	addi r5, r29, 0x0
/* 80025878 00022698  93 81 00 18 */	stw r28, 0x18(r1)
/* 8002587C 0002269C  3B 83 00 00 */	addi r28, r3, 0x0
/* 80025880 000226A0  38 DD 00 02 */	addi r6, r29, 0x2
/* 80025884 000226A4  A0 64 00 04 */	lhz r3, 0x4(r4)
/* 80025888 000226A8  1C 9C 01 10 */	mulli r4, r28, 0x110
/* 8002588C 000226AC  38 03 00 01 */	addi r0, r3, 0x1
/* 80025890 000226B0  3C 60 80 0A */	lis r3, __CARDBlock@ha
/* 80025894 000226B4  B0 1D 00 04 */	sth r0, 0x4(r29)
/* 80025898 000226B8  38 03 3D 40 */	addi r0, r3, __CARDBlock@l
/* 8002589C 000226BC  7F E0 22 14 */	add r31, r0, r4
/* 800258A0 000226C0  38 7D 00 04 */	addi r3, r29, 0x4
/* 800258A4 000226C4  38 80 1F FC */	li r4, 0x1ffc
/* 800258A8 000226C8  48 00 02 BD */	bl __CARDCheckSum
/* 800258AC 000226CC  38 7D 00 00 */	addi r3, r29, 0x0
/* 800258B0 000226D0  38 80 20 00 */	li r4, 0x2000
/* 800258B4 000226D4  48 01 72 9D */	bl DCStoreRange
/* 800258B8 000226D8  93 DF 00 D8 */	stw r30, 0xd8(r31)
/* 800258BC 000226DC  3C 60 80 02 */	lis r3, EraseCallback@ha
/* 800258C0 000226E0  38 A3 55 D8 */	addi r5, r3, EraseCallback@l
/* 800258C4 000226E4  80 1F 00 80 */	lwz r0, 0x80(r31)
/* 800258C8 000226E8  7F 83 E3 78 */	mr r3, r28
/* 800258CC 000226EC  80 9F 00 0C */	lwz r4, 0xc(r31)
/* 800258D0 000226F0  7C 00 E8 50 */	subf r0, r0, r29
/* 800258D4 000226F4  54 00 9B 7E */	srwi r0, r0, 13
/* 800258D8 000226F8  7C 84 01 D6 */	mullw r4, r4, r0
/* 800258DC 000226FC  4B FF E1 69 */	bl __CARDEraseSector
/* 800258E0 00022700  80 01 00 2C */	lwz r0, 0x2c(r1)
/* 800258E4 00022704  83 E1 00 24 */	lwz r31, 0x24(r1)
/* 800258E8 00022708  83 C1 00 20 */	lwz r30, 0x20(r1)
/* 800258EC 0002270C  83 A1 00 1C */	lwz r29, 0x1c(r1)
/* 800258F0 00022710  83 81 00 18 */	lwz r28, 0x18(r1)
/* 800258F4 00022714  38 21 00 28 */	addi r1, r1, 0x28
/* 800258F8 00022718  7C 08 03 A6 */	mtlr r0
/* 800258FC 0002271C  4E 80 00 20 */	blr
