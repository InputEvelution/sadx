.include "macros.s"

.section .text, "ax"  # 0x800058A0 - 0x800764A0 ; 0x00070C00


.global __CARDGetDirBlock
__CARDGetDirBlock:
/* 80025900 00022720  80 63 00 84 */	lwz r3, 0x84(r3)
/* 80025904 00022724  4E 80 00 20 */	blr

WriteCallback:
/* 80025908 00022728  7C 08 02 A6 */	mflr r0
/* 8002590C 0002272C  90 01 00 04 */	stw r0, 0x4(r1)
/* 80025910 00022730  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 80025914 00022734  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 80025918 00022738  93 C1 00 18 */	stw r30, 0x18(r1)
/* 8002591C 0002273C  7C 9E 23 79 */	mr. r30, r4
/* 80025920 00022740  93 A1 00 14 */	stw r29, 0x14(r1)
/* 80025924 00022744  3B A3 00 00 */	addi r29, r3, 0x0
/* 80025928 00022748  1C BD 01 10 */	mulli r5, r29, 0x110
/* 8002592C 0002274C  3C 60 80 0A */	lis r3, __CARDBlock@ha
/* 80025930 00022750  38 03 3D 40 */	addi r0, r3, __CARDBlock@l
/* 80025934 00022754  7F E0 2A 14 */	add r31, r0, r5
/* 80025938 00022758  41 80 00 44 */	blt lbl_8002597C
/* 8002593C 0002275C  80 7F 00 80 */	lwz r3, 0x80(r31)
/* 80025940 00022760  80 1F 00 84 */	lwz r0, 0x84(r31)
/* 80025944 00022764  38 83 20 00 */	addi r4, r3, 0x2000
/* 80025948 00022768  7C 00 20 40 */	cmplw r0, r4
/* 8002594C 0002276C  38 03 40 00 */	addi r0, r3, 0x4000
/* 80025950 00022770  40 82 00 18 */	bne lbl_80025968
/* 80025954 00022774  90 1F 00 84 */	stw r0, 0x84(r31)
/* 80025958 00022778  7C 03 03 78 */	mr r3, r0
/* 8002595C 0002277C  38 A0 20 00 */	li r5, 0x2000
/* 80025960 00022780  4B FD D8 89 */	bl memcpy
/* 80025964 00022784  48 00 00 18 */	b lbl_8002597C
lbl_80025968:
/* 80025968 00022788  90 9F 00 84 */	stw r4, 0x84(r31)
/* 8002596C 0002278C  38 64 00 00 */	addi r3, r4, 0x0
/* 80025970 00022790  7C 04 03 78 */	mr r4, r0
/* 80025974 00022794  38 A0 20 00 */	li r5, 0x2000
/* 80025978 00022798  4B FD D8 71 */	bl memcpy
lbl_8002597C:
/* 8002597C 0002279C  80 1F 00 D0 */	lwz r0, 0xd0(r31)
/* 80025980 000227A0  28 00 00 00 */	cmplwi r0, 0x0
/* 80025984 000227A4  40 82 00 10 */	bne lbl_80025994
/* 80025988 000227A8  38 7F 00 00 */	addi r3, r31, 0x0
/* 8002598C 000227AC  38 9E 00 00 */	addi r4, r30, 0x0
/* 80025990 000227B0  4B FF E3 39 */	bl __CARDPutControlBlock
lbl_80025994:
/* 80025994 000227B4  80 1F 00 D8 */	lwz r0, 0xd8(r31)
/* 80025998 000227B8  28 00 00 00 */	cmplwi r0, 0x0
/* 8002599C 000227BC  7C 0C 03 78 */	mr r12, r0
/* 800259A0 000227C0  41 82 00 1C */	beq lbl_800259BC
/* 800259A4 000227C4  38 00 00 00 */	li r0, 0x0
/* 800259A8 000227C8  7D 88 03 A6 */	mtlr r12
/* 800259AC 000227CC  90 1F 00 D8 */	stw r0, 0xd8(r31)
/* 800259B0 000227D0  38 7D 00 00 */	addi r3, r29, 0x0
/* 800259B4 000227D4  38 9E 00 00 */	addi r4, r30, 0x0
/* 800259B8 000227D8  4E 80 00 21 */	blrl
lbl_800259BC:
/* 800259BC 000227DC  80 01 00 24 */	lwz r0, 0x24(r1)
/* 800259C0 000227E0  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 800259C4 000227E4  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 800259C8 000227E8  83 A1 00 14 */	lwz r29, 0x14(r1)
/* 800259CC 000227EC  38 21 00 20 */	addi r1, r1, 0x20
/* 800259D0 000227F0  7C 08 03 A6 */	mtlr r0
/* 800259D4 000227F4  4E 80 00 20 */	blr

EraseCallback:
/* 800259D8 000227F8  7C 08 02 A6 */	mflr r0
/* 800259DC 000227FC  90 01 00 04 */	stw r0, 0x4(r1)
/* 800259E0 00022800  94 21 FF D8 */	stwu r1, -0x28(r1)
/* 800259E4 00022804  93 E1 00 24 */	stw r31, 0x24(r1)
/* 800259E8 00022808  3B E3 00 00 */	addi r31, r3, 0x0
/* 800259EC 0002280C  3C 60 80 0A */	lis r3, __CARDBlock@ha
/* 800259F0 00022810  93 C1 00 20 */	stw r30, 0x20(r1)
/* 800259F4 00022814  1C BF 01 10 */	mulli r5, r31, 0x110
/* 800259F8 00022818  93 A1 00 1C */	stw r29, 0x1c(r1)
/* 800259FC 0002281C  38 03 3D 40 */	addi r0, r3, __CARDBlock@l
/* 80025A00 00022820  7C 9D 23 79 */	mr. r29, r4
/* 80025A04 00022824  7F C0 2A 14 */	add r30, r0, r5
/* 80025A08 00022828  41 80 00 3C */	blt lbl_80025A44
/* 80025A0C 0002282C  80 BE 00 84 */	lwz r5, 0x84(r30)
/* 80025A10 00022830  3C 60 80 02 */	lis r3, WriteCallback@ha
/* 80025A14 00022834  80 1E 00 80 */	lwz r0, 0x80(r30)
/* 80025A18 00022838  38 E3 59 08 */	addi r7, r3, WriteCallback@l
/* 80025A1C 0002283C  80 7E 00 0C */	lwz r3, 0xc(r30)
/* 80025A20 00022840  7C 00 28 50 */	subf r0, r0, r5
/* 80025A24 00022844  54 00 9B 7E */	srwi r0, r0, 13
/* 80025A28 00022848  7C 83 01 D6 */	mullw r4, r3, r0
/* 80025A2C 0002284C  38 C5 00 00 */	addi r6, r5, 0x0
/* 80025A30 00022850  38 7F 00 00 */	addi r3, r31, 0x0
/* 80025A34 00022854  38 A0 20 00 */	li r5, 0x2000
/* 80025A38 00022858  4B FF FA 61 */	bl __CARDWrite
/* 80025A3C 0002285C  7C 7D 1B 79 */	mr. r29, r3
/* 80025A40 00022860  40 80 00 44 */	bge lbl_80025A84
lbl_80025A44:
/* 80025A44 00022864  80 1E 00 D0 */	lwz r0, 0xd0(r30)
/* 80025A48 00022868  28 00 00 00 */	cmplwi r0, 0x0
/* 80025A4C 0002286C  40 82 00 10 */	bne lbl_80025A5C
/* 80025A50 00022870  38 7E 00 00 */	addi r3, r30, 0x0
/* 80025A54 00022874  38 9D 00 00 */	addi r4, r29, 0x0
/* 80025A58 00022878  4B FF E2 71 */	bl __CARDPutControlBlock
lbl_80025A5C:
/* 80025A5C 0002287C  80 1E 00 D8 */	lwz r0, 0xd8(r30)
/* 80025A60 00022880  28 00 00 00 */	cmplwi r0, 0x0
/* 80025A64 00022884  7C 0C 03 78 */	mr r12, r0
/* 80025A68 00022888  41 82 00 1C */	beq lbl_80025A84
/* 80025A6C 0002288C  38 00 00 00 */	li r0, 0x0
/* 80025A70 00022890  7D 88 03 A6 */	mtlr r12
/* 80025A74 00022894  90 1E 00 D8 */	stw r0, 0xd8(r30)
/* 80025A78 00022898  38 7F 00 00 */	addi r3, r31, 0x0
/* 80025A7C 0002289C  38 9D 00 00 */	addi r4, r29, 0x0
/* 80025A80 000228A0  4E 80 00 21 */	blrl
lbl_80025A84:
/* 80025A84 000228A4  80 01 00 2C */	lwz r0, 0x2c(r1)
/* 80025A88 000228A8  83 E1 00 24 */	lwz r31, 0x24(r1)
/* 80025A8C 000228AC  83 C1 00 20 */	lwz r30, 0x20(r1)
/* 80025A90 000228B0  83 A1 00 1C */	lwz r29, 0x1c(r1)
/* 80025A94 000228B4  38 21 00 28 */	addi r1, r1, 0x28
/* 80025A98 000228B8  7C 08 03 A6 */	mtlr r0
/* 80025A9C 000228BC  4E 80 00 20 */	blr

.global __CARDUpdateDir
__CARDUpdateDir:
/* 80025AA0 000228C0  7C 08 02 A6 */	mflr r0
/* 80025AA4 000228C4  90 01 00 04 */	stw r0, 0x4(r1)
/* 80025AA8 000228C8  94 21 FF D8 */	stwu r1, -0x28(r1)
/* 80025AAC 000228CC  93 E1 00 24 */	stw r31, 0x24(r1)
/* 80025AB0 000228D0  93 C1 00 20 */	stw r30, 0x20(r1)
/* 80025AB4 000228D4  93 A1 00 1C */	stw r29, 0x1c(r1)
/* 80025AB8 000228D8  3B A4 00 00 */	addi r29, r4, 0x0
/* 80025ABC 000228DC  93 81 00 18 */	stw r28, 0x18(r1)
/* 80025AC0 000228E0  3B 83 00 00 */	addi r28, r3, 0x0
/* 80025AC4 000228E4  1C BC 01 10 */	mulli r5, r28, 0x110
/* 80025AC8 000228E8  3C 60 80 0A */	lis r3, __CARDBlock@ha
/* 80025ACC 000228EC  38 03 3D 40 */	addi r0, r3, __CARDBlock@l
/* 80025AD0 000228F0  7F C0 2A 14 */	add r30, r0, r5
/* 80025AD4 000228F4  80 1E 00 00 */	lwz r0, 0x0(r30)
/* 80025AD8 000228F8  2C 00 00 00 */	cmpwi r0, 0x0
/* 80025ADC 000228FC  40 82 00 0C */	bne lbl_80025AE8
/* 80025AE0 00022900  38 60 FF FD */	li r3, -0x3
/* 80025AE4 00022904  48 00 00 60 */	b lbl_80025B44
lbl_80025AE8:
/* 80025AE8 00022908  83 FE 00 84 */	lwz r31, 0x84(r30)
/* 80025AEC 0002290C  38 80 1F FC */	li r4, 0x1ffc
/* 80025AF0 00022910  A8 BF 1F FA */	lha r5, 0x1ffa(r31)
/* 80025AF4 00022914  38 DF 1F C0 */	addi r6, r31, 0x1fc0
/* 80025AF8 00022918  38 7F 00 00 */	addi r3, r31, 0x0
/* 80025AFC 0002291C  38 05 00 01 */	addi r0, r5, 0x1
/* 80025B00 00022920  B0 1F 1F FA */	sth r0, 0x1ffa(r31)
/* 80025B04 00022924  38 A6 00 3C */	addi r5, r6, 0x3c
/* 80025B08 00022928  38 C6 00 3E */	addi r6, r6, 0x3e
/* 80025B0C 0002292C  48 00 00 59 */	bl __CARDCheckSum
/* 80025B10 00022930  38 7F 00 00 */	addi r3, r31, 0x0
/* 80025B14 00022934  38 80 20 00 */	li r4, 0x2000
/* 80025B18 00022938  48 01 70 39 */	bl DCStoreRange
/* 80025B1C 0002293C  93 BE 00 D8 */	stw r29, 0xd8(r30)
/* 80025B20 00022940  3C 60 80 02 */	lis r3, EraseCallback@ha
/* 80025B24 00022944  38 A3 59 D8 */	addi r5, r3, EraseCallback@l
/* 80025B28 00022948  80 1E 00 80 */	lwz r0, 0x80(r30)
/* 80025B2C 0002294C  7F 83 E3 78 */	mr r3, r28
/* 80025B30 00022950  80 9E 00 0C */	lwz r4, 0xc(r30)
/* 80025B34 00022954  7C 00 F8 50 */	subf r0, r0, r31
/* 80025B38 00022958  54 00 9B 7E */	srwi r0, r0, 13
/* 80025B3C 0002295C  7C 84 01 D6 */	mullw r4, r4, r0
/* 80025B40 00022960  4B FF DF 05 */	bl __CARDEraseSector
lbl_80025B44:
/* 80025B44 00022964  80 01 00 2C */	lwz r0, 0x2c(r1)
/* 80025B48 00022968  83 E1 00 24 */	lwz r31, 0x24(r1)
/* 80025B4C 0002296C  83 C1 00 20 */	lwz r30, 0x20(r1)
/* 80025B50 00022970  83 A1 00 1C */	lwz r29, 0x1c(r1)
/* 80025B54 00022974  83 81 00 18 */	lwz r28, 0x18(r1)
/* 80025B58 00022978  38 21 00 28 */	addi r1, r1, 0x28
/* 80025B5C 0002297C  7C 08 03 A6 */	mtlr r0
/* 80025B60 00022980  4E 80 00 20 */	blr
