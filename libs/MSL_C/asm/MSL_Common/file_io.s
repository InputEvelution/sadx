.include "macros.s"

.section .text, "ax"  # 0x800058A0 - 0x800764A0 ; 0x00070C00


.global fflush
fflush:
/* 8000B134 00007F54  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 8000B138 00007F58  7C 08 02 A6 */	mflr r0
/* 8000B13C 00007F5C  90 01 00 14 */	stw r0, 0x14(r1)
/* 8000B140 00007F60  93 E1 00 0C */	stw r31, 0xc(r1)
/* 8000B144 00007F64  7C 7F 1B 79 */	mr. r31, r3
/* 8000B148 00007F68  93 C1 00 08 */	stw r30, 0x8(r1)
/* 8000B14C 00007F6C  40 82 00 0C */	bne lbl_8000B158
/* 8000B150 00007F70  4B FF DE 05 */	bl __flush_all
/* 8000B154 00007F74  48 00 01 00 */	b lbl_8000B254
lbl_8000B158:
/* 8000B158 00007F78  88 1F 00 0A */	lbz r0, 0xa(r31)
/* 8000B15C 00007F7C  28 00 00 00 */	cmplwi r0, 0x0
/* 8000B160 00007F80  40 82 00 10 */	bne lbl_8000B170
/* 8000B164 00007F84  A0 1F 00 04 */	lhz r0, 0x4(r31)
/* 8000B168 00007F88  54 00 D7 7F */	rlwinm. r0, r0, 26, 29, 31
/* 8000B16C 00007F8C  40 82 00 0C */	bne lbl_8000B178
lbl_8000B170:
/* 8000B170 00007F90  38 60 FF FF */	li r3, -0x1
/* 8000B174 00007F94  48 00 00 E0 */	b lbl_8000B254
lbl_8000B178:
/* 8000B178 00007F98  88 1F 00 04 */	lbz r0, 0x4(r31)
/* 8000B17C 00007F9C  54 00 EF 7E */	rlwinm r0, r0, 29, 29, 31
/* 8000B180 00007FA0  28 00 00 01 */	cmplwi r0, 0x1
/* 8000B184 00007FA4  40 82 00 0C */	bne lbl_8000B190
/* 8000B188 00007FA8  38 60 00 00 */	li r3, 0x0
/* 8000B18C 00007FAC  48 00 00 C8 */	b lbl_8000B254
lbl_8000B190:
/* 8000B190 00007FB0  88 7F 00 08 */	lbz r3, 0x8(r31)
/* 8000B194 00007FB4  54 60 DF 7E */	rlwinm r0, r3, 27, 29, 31
/* 8000B198 00007FB8  28 00 00 03 */	cmplwi r0, 0x3
/* 8000B19C 00007FBC  41 80 00 10 */	blt lbl_8000B1AC
/* 8000B1A0 00007FC0  38 00 00 02 */	li r0, 0x2
/* 8000B1A4 00007FC4  50 03 2E 34 */	rlwimi r3, r0, 5, 24, 26
/* 8000B1A8 00007FC8  98 7F 00 08 */	stb r3, 0x8(r31)
lbl_8000B1AC:
/* 8000B1AC 00007FCC  88 1F 00 08 */	lbz r0, 0x8(r31)
/* 8000B1B0 00007FD0  54 00 DF 7E */	rlwinm r0, r0, 27, 29, 31
/* 8000B1B4 00007FD4  28 00 00 02 */	cmplwi r0, 0x2
/* 8000B1B8 00007FD8  40 82 00 0C */	bne lbl_8000B1C4
/* 8000B1BC 00007FDC  38 00 00 00 */	li r0, 0x0
/* 8000B1C0 00007FE0  90 1F 00 28 */	stw r0, 0x28(r31)
lbl_8000B1C4:
/* 8000B1C4 00007FE4  88 9F 00 08 */	lbz r4, 0x8(r31)
/* 8000B1C8 00007FE8  54 80 DF 7E */	rlwinm r0, r4, 27, 29, 31
/* 8000B1CC 00007FEC  28 00 00 01 */	cmplwi r0, 0x1
/* 8000B1D0 00007FF0  41 82 00 18 */	beq lbl_8000B1E8
/* 8000B1D4 00007FF4  38 00 00 00 */	li r0, 0x0
/* 8000B1D8 00007FF8  38 60 00 00 */	li r3, 0x0
/* 8000B1DC 00007FFC  50 04 2E 34 */	rlwimi r4, r0, 5, 24, 26
/* 8000B1E0 00008000  98 9F 00 08 */	stb r4, 0x8(r31)
/* 8000B1E4 00008004  48 00 00 70 */	b lbl_8000B254
lbl_8000B1E8:
/* 8000B1E8 00008008  A0 1F 00 04 */	lhz r0, 0x4(r31)
/* 8000B1EC 0000800C  54 00 D7 7E */	rlwinm r0, r0, 26, 29, 31
/* 8000B1F0 00008010  28 00 00 01 */	cmplwi r0, 0x1
/* 8000B1F4 00008014  41 82 00 0C */	beq lbl_8000B200
/* 8000B1F8 00008018  3B C0 00 00 */	li r30, 0x0
/* 8000B1FC 0000801C  48 00 00 10 */	b lbl_8000B20C
lbl_8000B200:
/* 8000B200 00008020  7F E3 FB 78 */	mr r3, r31
/* 8000B204 00008024  48 00 03 85 */	bl ftell
/* 8000B208 00008028  7C 7E 1B 78 */	mr r30, r3
lbl_8000B20C:
/* 8000B20C 0000802C  7F E3 FB 78 */	mr r3, r31
/* 8000B210 00008030  38 80 00 00 */	li r4, 0x0
/* 8000B214 00008034  4B FF FA B5 */	bl __flush_buffer
/* 8000B218 00008038  2C 03 00 00 */	cmpwi r3, 0x0
/* 8000B21C 0000803C  41 82 00 1C */	beq lbl_8000B238
/* 8000B220 00008040  38 60 00 01 */	li r3, 0x1
/* 8000B224 00008044  38 00 00 00 */	li r0, 0x0
/* 8000B228 00008048  98 7F 00 0A */	stb r3, 0xa(r31)
/* 8000B22C 0000804C  38 60 FF FF */	li r3, -0x1
/* 8000B230 00008050  90 1F 00 28 */	stw r0, 0x28(r31)
/* 8000B234 00008054  48 00 00 20 */	b lbl_8000B254
lbl_8000B238:
/* 8000B238 00008058  88 1F 00 08 */	lbz r0, 0x8(r31)
/* 8000B23C 0000805C  38 80 00 00 */	li r4, 0x0
/* 8000B240 00008060  50 80 2E 34 */	rlwimi r0, r4, 5, 24, 26
/* 8000B244 00008064  38 60 00 00 */	li r3, 0x0
/* 8000B248 00008068  98 1F 00 08 */	stb r0, 0x8(r31)
/* 8000B24C 0000806C  93 DF 00 18 */	stw r30, 0x18(r31)
/* 8000B250 00008070  90 9F 00 28 */	stw r4, 0x28(r31)
lbl_8000B254:
/* 8000B254 00008074  80 01 00 14 */	lwz r0, 0x14(r1)
/* 8000B258 00008078  83 E1 00 0C */	lwz r31, 0xc(r1)
/* 8000B25C 0000807C  83 C1 00 08 */	lwz r30, 0x8(r1)
/* 8000B260 00008080  7C 08 03 A6 */	mtlr r0
/* 8000B264 00008084  38 21 00 10 */	addi r1, r1, 0x10
/* 8000B268 00008088  4E 80 00 20 */	blr

.global fclose
fclose:
/* 8000B26C 0000808C  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 8000B270 00008090  7C 08 02 A6 */	mflr r0
/* 8000B274 00008094  90 01 00 24 */	stw r0, 0x24(r1)
/* 8000B278 00008098  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 8000B27C 0000809C  93 C1 00 18 */	stw r30, 0x18(r1)
/* 8000B280 000080A0  93 A1 00 14 */	stw r29, 0x14(r1)
/* 8000B284 000080A4  7C 7D 1B 79 */	mr. r29, r3
/* 8000B288 000080A8  40 82 00 0C */	bne lbl_8000B294
/* 8000B28C 000080AC  38 60 FF FF */	li r3, -0x1
/* 8000B290 000080B0  48 00 00 80 */	b lbl_8000B310
lbl_8000B294:
/* 8000B294 000080B4  A0 1D 00 04 */	lhz r0, 0x4(r29)
/* 8000B298 000080B8  54 00 D7 7F */	rlwinm. r0, r0, 26, 29, 31
/* 8000B29C 000080BC  40 82 00 0C */	bne lbl_8000B2A8
/* 8000B2A0 000080C0  38 60 00 00 */	li r3, 0x0
/* 8000B2A4 000080C4  48 00 00 6C */	b lbl_8000B310
lbl_8000B2A8:
/* 8000B2A8 000080C8  4B FF FE 8D */	bl fflush
/* 8000B2AC 000080CC  81 9D 00 44 */	lwz r12, 0x44(r29)
/* 8000B2B0 000080D0  7C 7E 1B 78 */	mr r30, r3
/* 8000B2B4 000080D4  80 7D 00 00 */	lwz r3, 0x0(r29)
/* 8000B2B8 000080D8  7D 89 03 A6 */	mtctr r12
/* 8000B2BC 000080DC  4E 80 04 21 */	bctrl
/* 8000B2C0 000080E0  A0 1D 00 04 */	lhz r0, 0x4(r29)
/* 8000B2C4 000080E4  38 80 00 00 */	li r4, 0x0
/* 8000B2C8 000080E8  50 80 35 F2 */	rlwimi r0, r4, 6, 23, 25
/* 8000B2CC 000080EC  7C 7F 1B 78 */	mr r31, r3
/* 8000B2D0 000080F0  B0 1D 00 04 */	sth r0, 0x4(r29)
/* 8000B2D4 000080F4  90 9D 00 00 */	stw r4, 0x0(r29)
/* 8000B2D8 000080F8  88 1D 00 08 */	lbz r0, 0x8(r29)
/* 8000B2DC 000080FC  54 00 E7 FF */	rlwinm. r0, r0, 28, 31, 31
/* 8000B2E0 00008100  41 82 00 0C */	beq lbl_8000B2EC
/* 8000B2E4 00008104  80 7D 00 1C */	lwz r3, 0x1c(r29)
/* 8000B2E8 00008108  4B FF D7 05 */	bl free
lbl_8000B2EC:
/* 8000B2EC 0000810C  2C 1E 00 00 */	cmpwi r30, 0x0
/* 8000B2F0 00008110  38 60 00 00 */	li r3, 0x0
/* 8000B2F4 00008114  40 82 00 0C */	bne lbl_8000B300
/* 8000B2F8 00008118  2C 1F 00 00 */	cmpwi r31, 0x0
/* 8000B2FC 0000811C  41 82 00 08 */	beq lbl_8000B304
lbl_8000B300:
/* 8000B300 00008120  38 60 00 01 */	li r3, 0x1
lbl_8000B304:
/* 8000B304 00008124  7C 03 00 D0 */	neg r0, r3
/* 8000B308 00008128  7C 00 1B 78 */	or r0, r0, r3
/* 8000B30C 0000812C  7C 03 FE 70 */	srawi r3, r0, 31
lbl_8000B310:
/* 8000B310 00008130  80 01 00 24 */	lwz r0, 0x24(r1)
/* 8000B314 00008134  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 8000B318 00008138  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 8000B31C 0000813C  83 A1 00 14 */	lwz r29, 0x14(r1)
/* 8000B320 00008140  7C 08 03 A6 */	mtlr r0
/* 8000B324 00008144  38 21 00 20 */	addi r1, r1, 0x20
/* 8000B328 00008148  4E 80 00 20 */	blr

